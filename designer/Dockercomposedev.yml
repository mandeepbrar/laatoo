version: '3'
services:
  designer:
    build:
      context: .
      dockerfile: Dockerfile.designertest
    volumes:
      - /home/mandeep/goprogs/src/laatoo/designer/dist/config/designer:/config/environments/designer
      - /home/mandeep/goprogs/src/laatoo/dist/bin:/laatoobin
      - /home/mandeep/goprogs/src/laatoo/designer/dist/appfiles:/bin/appfiles
      - /home/mandeep/goprogs/src/laatoo/designer/dist/publicdir:/bin/publicdir
      - /home/mandeep/goprogs/src/laatoo/designer/modules:/modules
      - /home/mandeep/goprogs/src/laatoo/designer/modulesrepo:/modulesrepo
      - /home/mandeep/goprogs/src/laatoo:/devmodulesrepo
      - /home/mandeep/goprogs/src/laatoo/ui/nodemodules:/nodemodules
      - /home/mandeep/goprogs:/plugins
      - /home/mandeep/goprogs/src/laatoo/designer/modules:/deploy
    ports:
      - "6060:6060"
      - "6061:6061"
    depends_on:
      - mongo
      - cadence
    environment:
      - LAATOO_mongoconnectionstring=mongo
    logging:
      driver: syslog
  mongo:
    image: mongo
    ports:
      - "27017:27017"
    volumes:
      - /backups/punjabimehfilmongo:/data/db
  cassandra:
    image: cassandra:3.11
    ports:
      - "9042:9042"
  statsd:
    image: hopsoft/graphite-statsd
    ports:
      - "8080:80"
      - "2003:2003"
      - "8125:8125"
      - "8126:8126"
  cadence:
    image: ubercadence/server:master-auto-setup
    ports:
      - "7933:7933"
      - "7934:7934"
      - "7935:7935"
      - "7939:7939"
    environment:
      - "CASSANDRA_SEEDS=cassandra"
      - "STATSD_ENDPOINT=statsd:8125"
      - "DYNAMIC_CONFIG_FILE_PATH=config/dynamicconfig/development.yaml"
    depends_on:
      - cassandra
      - statsd
  cadence-web:
    image: ubercadence/web:3.4.1
    environment:
      - "CADENCE_TCHANNEL_PEERS=cadence:7933"
    ports:
      - "8088:8088"
    depends_on:
      - cadence    
volumes:
  logvolume01: {}


