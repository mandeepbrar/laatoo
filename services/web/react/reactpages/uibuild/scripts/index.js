define("reactpages",["react","prop-types","reactwebcommon","redux"],(function(e,t,n,o){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=14)}([function(t,n){t.exports=e},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,n){e.exports=t},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}e.exports=function(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e}},function(e,t,n){var o=n(12),r=n(1);e.exports=function(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?r(e):t}},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t,n){var o=n(13);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}},function(e,t){e.exports=n},function(e,t){e.exports=o},function(e,t){},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(t){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?e.exports=o=function(e){return n(e)}:e.exports=o=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},o(t)}e.exports=o},function(e,t){function n(t,o){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,o)}e.exports=n},function(e,t,n){"use strict";n.r(t);var o,r=n(0),a=n.n(r),l=(n(11),n(4)),i=n.n(l),c=n(5),s=n.n(c),u=n(6),p=n.n(u),f=n(7),m=n.n(f),y=n(1),g=n.n(y),d=n(8),v=n.n(d),b=n(2),h=n.n(b),k=n(3),w=n.n(k),x=n(9),P=function(e){function t(e,n){var l;i()(this,t),l=p()(this,m()(t).call(this,e)),h()(g()(l),"getPanelItems",(function(e){return e?e instanceof Array?e.map((function(e){return console.log("rendering panel array element",e),a.a.createElement(t,{description:e})})):a.a.createElement(t,{description:e}):null})),h()(g()(l),"cfgPanel",(function(e,t){!l.title&&e&&(l.title=e),!l.overlay&&t&&(l.overlay=t)})),h()(g()(l),"processLayout",(function(e,t,n){if(e&&e.layout){l.cfgPanel(e.title,e.overlay);var o=g()(l),r=null,i=function(t){return console.log("looking for panel component in layout",e,t),e[t]?a.a.createElement(_uikit.Block,{className:t},o.getPanelItems(e[t])):a.a.createElement(_uikit.Block,null)};l.getView=function(t,n,o,l){switch(console.log("getting layout",e,t),e.layout){case"2col":r=a.a.createElement(_uikit.Block,{className:l+" fd fdcol w100 twocol"},i("headerrow"),a.a.createElement(_uikit.Block,{className:" fd fdgrow fdrow "},i("leftcol"),i("rightcol")),i("footerrow"));break;case"3col":r=a.a.createElement(_uikit.Block,{className:l+" fd fdcol w100 threecol"},i("headerrow"),a.a.createElement(_uikit.Block,{className:" fd fdgrow fdrow "},i("leftcol"),i("rightcol")),i("footerrow"));break;default:r=a.a.createElement(_uikit.Block,{className:l+" fd fdcol w100 "},i("items"))}return r}}})),h()(g()(l),"processMenu",(function(e,t,n){l.getView=function(t,n,o,r){return console.log("rendering menu",e,t,n,r),a.a.createElement(x.Menu,{id:e.id,vertical:e.vertical,className:r})}})),h()(g()(l),"processBlock",(function(e,t,n){var o=l.getDisplayFunc(e,t),i=null,c=null;e.expansionBlock&&(c={id:e.expansionBlock,type:"block"},i=l.getDisplayFunc(c)),l.cfgPanel(e.title,e.overlay),console.log("processing block",e,o,t);var s=g()(l),u=function(e){console.log("expanding",s.state),s.setState(Object.assign({},s.state,{expanded:!s.state.expanded}))};l.getView=o?function(t,n,a,l){console.log("use stat",r.useState,a,u),console.log("calling block func",t,n,a,l,a.expanded);var p=t.expanded;if(null!=p&&0==p)return null;var f={data:t.data,expanded:a.expanded,expand:u,props:t,panel:s,className:l,routeParams:n.routeParams,storage:Storage,state:a};console.log("block blockCtx",f,"desc",e,"expansionDesc",c,"display",o);var m=o(f,e);return a.expanded&&i?[m,i(f,c)]:(console.log("retval from block",m,"props",t,"contentonly",t.contentOnly),m&&t.contentOnly?m.children:m)}:function(e,t,n,o){return console.log("rendering empty block func",e,t,o),a.a.createElement(_uikit.Block,null)}})),h()(g()(l),"createMarkup",(function(e){return{__html:e}})),h()(g()(l),"processHtml",(function(e,t,n){l.cfgPanel(e.title,e.overlay),e.html?l.getView=function(t,n,o,r){return console.log("rendering html",e.html),a.a.createElement("div",{className:r,dangerouslySetInnerHTML:this.createMarkup(e.html)})}:l.getView=function(e,t,n,o){return a.a.createElement(_uikit.Block,null)}})),h()(g()(l),"processForm",(function(e,t,n){if(console.log("processing form=",e,t),e&&e.info){l.cfgPanel(e.info.title,e.info.overlay);var r=e.formName?e.formName:e.id;console.log("processing form+++",e,r,t,e.formName,e.id);var i=Object.assign({},e.info,t.info);l.form||(console.log("getting form",o),l.form=_res("reactforms","Form"),console.log("got form",o)),l.form?l.getView=function(t,n,o,l){var c=i;return t.subform||(c=Object.assign({},i,n.routeParams)),console.log("form cfg",c,i,t,r),a.a.createElement(this.form,{form:r,parentFormRef:t.parentFormRef,formContext:{data:t.data,routeParams:n.routeParams,storage:Storage},info:c,inline:t.inline,onChange:t.onChange,trackChanges:t.trackChanges,formData:t.formData,subform:t.subform,onFormSubmit:t.onFormSubmit,title:t.title,actions:t.actions,description:e,className:l,id:e.id})}:l.getView=function(e,t,n,o){return a.a.createElement(_uikit.Block,null)}}})),h()(g()(l),"processView",(function(e,n,r){console.log("processing my view",e,n,o),l.cfgPanel(e.title,e.overlay);var i=e.header?a.a.createElement(t,{id:e.header,type:"block"}):null;l.view||(l.view=_res("laatooviews","View"));var c=_tn(n.postArgs,e.postArgs);console.log("processing view",l.view),l.getView=function(n,o,r,l){return console.log("rendering view",this.view,n,e,l,c),a.a.createElement(this.view,{params:n.params,description:e,getItem:n.getItem,editable:n.editable,className:l,header:i,viewRef:n.viewRef,postArgs:c,urlParams:n.urlParams,contentOnly:n.contentOnly,id:e.id,instance:n.instance},a.a.createElement(t,{parent:n.parent,description:e.item,viewdepth:n.viewdepth}))}})),h()(g()(l),"processEntity",(function(e,n,o){l.entity||(l.entity=_res("laatooviews","Entity")),l.getView=function(e,n,o,r){var l=e.description,i=l.entityDisplay?l.entityDisplay:"default";console.log("view entity description",l,i,e,n),this.cfgPanel(l.title,l.overlay);var c,s={type:"block",id:l.entityName+"_"+i,defaultBlock:l.entityName+"_default"},u="";u=n.routeParams&&n.routeParams.entityId?n.routeParams.entityId:l.entityId,c=l.entityName;var p=e.data?e.data:l.data,f=e.index,m="";return e.index&&(m=e.index%2?"oddindex":"evenindex"),console.log("my entity data",p,f,l,e,u,n),a.a.createElement(this.entity,{id:u,name:c,entityDescription:l,data:p,index:f},a.a.createElement(t,{description:s,parent:e.parent,className:m}))}})),h()(g()(l),"overlayComponent",(function(e){console.log("overlaying component"),l.overlay?l.setState(Object.assign({},l.state,{overlayComponent:e})):l.context&&l.context.overlayComponent&&l.context.overlayComponent(e)})),h()(g()(l),"closeOverlay",(function(){l.overlay?l.setState({},l.state,{overlayComponent:null}):l.context&&l.context.closeOverlay&&l.context.closeOverlay()}));var c=e.description,s=e.id?e.id:c&&c.id?c.id:null,u=e.type?e.type:c&&c.type?c.type:"layout";if(s){var f=c?c.info:null;switch(u){case"view":c=_reg("Views",s);break;case"form":c=_reg("Forms",s);break;case"block":break;case"menu":c=_reg("Menus",s);break;case"component":break;default:c=_reg("Panels",s)}console.log("desc before assigne",e.description,e,s,u,Application),c=Object.assign({type:u,id:s},c),console.log("desc after assign",c,c.info,f),c.info=Object.assign({},c.info,f)}l.title=e.title?e.title:c&&c.title?c.title:null,l.closePanel=e.closePanel?e.closePanel:null,console.log("creating panel",c,e,n,l.context);var y,d=e.className?e.className+" panel ":" panel ";if(c.id&&(d=d+" "+c.id),c.name&&(d=d+" "+c.name),c.className&&(d=d+" "+c.className),l.overlay=e.overlay?e.overlay:null,c&&"string"==typeof c)l.processBlock(c,e);else if(c)switch(c.type){case"view":d+=" view ",l.processView(c,e,n);break;case"entity":d+=" entity ",l.processEntity(c,e,n);break;case"form":d+=" form ",l.processForm(c,e,n);break;case"html":d+=" html ",l.processHtml(c,e,n);break;case"block":d+=" panelblock ",l.processBlock(c,e,n);break;case"layout":d+=" layout ",l.processLayout(c,e,n);break;case"menu":d+=" menu ",l.processMenu(c,e,n);break;case"component":if(c.component)l.getView=function(e,t,n){return c.component};else{var v=_res(c.module,c.componentName);console.log("component from module",v,c),l.getView=(y=v,function(e,t,n,o){var r={description:c,className:o},l=c.props?Object.assign({},c.props,r):Object.assign({},c,r);return a.a.createElement(y,l)})}break;default:var b=_reg("PanelTypes",c.type);l.getView=function(e,t,n){return console.log("unknown comp type",c.type,c),null!=b?b.getComponent(c,e,t,n):a.a.createElement(_uikit.Block,null)}}return console.log("class name",l.className,d,c),l.state={expanded:!1,overlayComponent:null},l.className=d,l}return v()(t,e),s()(t,[{key:"getDisplayFunc",value:function(e,t){if(console.log("getting display func",e),!e)return console.log("returning null display func",e),null;if("string"==typeof e)return _reg("Blocks",e);var n=e.id,o=_reg("Blocks",n);return o||(o=_reg("Blocks",e.defaultBlock)),console.log("returning display func",o,Application),o}},{key:"getChildContext",value:function(){return console.log("getting child contextoverlaying component",this.overlay,this.props,this.context),this.overlay?{overlayComponent:this.overlayComponent,closeOverlay:this.closeOverlay}:this.context&&this.context.overlayComponent?{overlayComponent:this.context.overlayComponent,closeOverlay:this.closeOverlay}:null}},{key:"render",value:function(){var e=this.overlay&&this.state&&this.state.overlayComponent,t=this.getView?this.getView(this.props,this.context,this.state,this.title?"":this.className):a.a.createElement(_uikit.Block,null);return console.log("Rendering panel***************",this.getView,this.props,t,this.overlay,this.title,this.closePanel,this.className),!this.props.contentOnly&&(this.overlay||this.title||this.closePanel)?a.a.createElement(_uikit.Block,{className:"overlaywrapper",title:this.title,closeBlock:this.closePanel},a.a.createElement(_uikit.Block,{style:{display:e?"none":"block"}},t),e?this.state.overlayComponent:null):t||a.a.createElement(_uikit.Block,null)}}],[{key:"setModule",value:function(e){o=e}}]),t}(a.a.Component);P.childContextTypes={overlayComponent:w.a.func,closeOverlay:w.a.func},P.contextTypes={overlayComponent:w.a.func,closeOverlay:w.a.func,routeParams:w.a.object};var _=P,O=n(10);n.d(t,"Initialize",(function(){return C})),n.d(t,"ProcessPages",(function(){return N})),n.d(t,"Panel",(function(){return _}));var E;n(3);function C(e,t,n,o,r,a){(E=this).properties=Application.Properties[t],E.settings=o,E.req=a,_.setModule(E)}function N(e){var t=Application.AllRegItems("Pages");if(t)for(var n in t)try{!function(){var o=t[n],r=j(o),a=o.components;o.component&&(a={main:o.component}),e&&e.PreprocessPageComponents&&(a=e.PreprocessPageComponents(a,o,n,r));var l={};console.log("page components ",n,o,a),Object.keys(a).forEach((function(t){l[t]=function(t,n,o,r){return function(a){var l=!0;if(console.log("Page components ",a,t,n,o,r),e&&e.IsComponentVisible&&(l=e.IsComponentVisible(compToRender,n,o,a,r)),l){var i="function"==typeof t?t(a):t;if(e&&e.RenderPageComponent){var c=e.RenderPageComponent(i,n,o,a,r);if(c)return c}return i}return null}}(a[t],t,n,o)}));var i={pattern:o.route,components:l,reducer:Object(O.combineReducers)(r)};console.log("page ....",i),Application.Register("Routes",n,i),Application.Register("Actions","Page_"+n,{url:i.pattern})}()}catch(e){console.log(e)}}function j(e){var t={};for(var n in e.datasources)try{var o=_reg("Datasources",n),r={};o.type;var a=o.module;if(a){var l=E.req(a);l&&(r=l[o.processor])}r&&(t[n]=r)}catch(e){}return t}Window.resolvePanel=function(e,t){return a.a.createElement(_,{type:e,id:t})}}])}));
//# sourceMappingURL=index.js.map